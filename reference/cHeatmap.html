<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot heatmaps — cHeatmap • cHeatmap</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot heatmaps — cHeatmap"><meta name="description" content="This is a wrapper of the ComplexHeatmap::Heatmap() with additional
functions and more friendly interfaces for some common tasks in plotting heatmaps."><meta property="og:description" content="This is a wrapper of the ComplexHeatmap::Heatmap() with additional
functions and more friendly interfaces for some common tasks in plotting heatmaps."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cHeatmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/cHeatmap-intro.html">convenience Heatmap</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/blueskypie/cHeatmap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot heatmaps</h1>
      <small class="dont-index">Source: <a href="https://github.com/blueskypie/cHeatmap/blob/main/R/cHeatmap.R" class="external-link"><code>R/cHeatmap.R</code></a></small>
      <div class="d-none name"><code>cHeatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a wrapper of the <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> with additional
functions and more friendly interfaces for some common tasks in plotting heatmaps.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cHeatmap</span><span class="op">(</span></span>
<span>  <span class="va">mat1</span>,</span>
<span>  NA.color <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>  whiteValue <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  colMap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>green4 <span class="op">=</span> <span class="cn">NA</span>, white <span class="op">=</span> <span class="va">whiteValue</span>, red <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  intAsDiscreteCutoff <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  legendPos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"left"</span>, <span class="st">"bottom"</span>, <span class="st">"top"</span><span class="op">)</span>,</span>
<span>  nRowCluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nColmCluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rowAnnoDf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colmAnnoDf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rowAnnoPara <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>na_col <span class="op">=</span> <span class="va">NA.color</span><span class="op">)</span>,</span>
<span>  colmAnnoPara <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>na_col <span class="op">=</span> <span class="va">NA.color</span><span class="op">)</span>,</span>
<span>  rowAnnoColMap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  colmAnnoColMap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  drawHeatmap <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  resetOutliers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span>,</span>
<span>  clusterUsingResetValues <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cellFun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cfMat <span class="op">=</span> <span class="va">mat1</span>,</span>
<span>  cellFontSize <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  cellFontColor <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  rowDraw <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legendBreakDist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legendHeight <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legendTicks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legendTickLabels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mat-">mat1<a class="anchor" aria-label="anchor" href="#arg-mat-"></a></dt>
<dd><p>A numeric or character matrix or data frame, required.</p></dd>


<dt id="arg-na-color">NA.color<a class="anchor" aria-label="anchor" href="#arg-na-color"></a></dt>
<dd><p>character,'grey'; the color for missing values in <code>mat1</code>,
<code>rowAnnoDf</code>, or <code>colmAnnoDf</code>. If missing values are present, a square
of <code>NA.color</code> will be added to the legend.</p></dd>


<dt id="arg-whitevalue">whiteValue<a class="anchor" aria-label="anchor" href="#arg-whitevalue"></a></dt>
<dd><p>Numeric, <code>NULL</code>; it is the value of the white or middle color
in the legend if <code>mat1</code> is numeric and <code>colMap</code> consists of three colors.</p></dd>


<dt id="arg-colmap">colMap<a class="anchor" aria-label="anchor" href="#arg-colmap"></a></dt>
<dd><p>A vector, <code>c("green4"=NA, "white"=whiteValue, "red"=NA)</code>;
it defines the colors used in the heatmap and their mapping to values,
and therefore should be supplied as a named vector.</p><ul><li><p>For character <code>mat1</code>, <code>colMap</code> is a character vector, i.e.
<code>c('red'='a','pink'='b','yellow'='c')</code> if the unique
values in <code>mat1</code> are <code>a</code>, <code>b</code>, and <code>c</code>.</p></li>
<li><p>For numeric <code>mat1</code>, <code>colMap</code> is a numeric vector, i.e.
<code>c('blue'= NA,'green'=5, 'red'=10)</code></p><ol><li><p><code>colMap</code> can be supplied w/o names for convenience,
i.e. <code>c(-1, 0, 3)</code>; in this case, the length must be three and names are
assumed to be <code>c("green4", "white", "red")</code></p></li>
<li><p>The first and last value of <code>colMap</code> are the lower and upper bounds of
displayed values; values outside of that range will be considered as
outliers.</p></li>
<li><p>One or both of the first and last values of <code>colMap</code> can be supplied as NA;
then outliers will be auto-computed if <code>resetOutliers</code> is <code>TRUE</code>.</p></li>
</ol></li>
</ul></dd>


<dt id="arg-intasdiscretecutoff">intAsDiscreteCutoff<a class="anchor" aria-label="anchor" href="#arg-intasdiscretecutoff"></a></dt>
<dd><p>integer, 6; if <code>mat1</code> is an integer matrix and has &lt; 6
unique values, the color mapping in the legend will be discrete.</p></dd>


<dt id="arg-legendpos">legendPos<a class="anchor" aria-label="anchor" href="#arg-legendpos"></a></dt>
<dd><p>one of <code>c("right", "left", "bottom", "top")</code></p></dd>


<dt id="arg-nrowcluster-ncolmcluster">nRowCluster, nColmCluster<a class="anchor" aria-label="anchor" href="#arg-nrowcluster-ncolmcluster"></a></dt>
<dd><p>integer, <code>NULL</code>; number of colored clusters in row or
column; different clusters will be in different colors. If this argument
is set, it assumes <code>cluster_rows</code> and <code>cluster_columns</code> are <code>TRUE</code>; so
do <strong>NOT</strong> explicitly set those two arguments again.
To also split, i.e. columns, set <code>column_split = nColmCluster</code>.</p></dd>


<dt id="arg-rowannodf-colmannodf">rowAnnoDf, colmAnnoDf<a class="anchor" aria-label="anchor" href="#arg-rowannodf-colmannodf"></a></dt>
<dd><p>matrix or data frame, <code>NULL</code>; annotation for row
or column. The rows of the <code>rowAnnoDf</code>/<code>colmAnnoDf</code> should be of the same
length and order of the row/column of <code>mat1</code>.</p></dd>


<dt id="arg-rowannopara-colmannopara">rowAnnoPara, colmAnnoPara<a class="anchor" aria-label="anchor" href="#arg-rowannopara-colmannopara"></a></dt>
<dd><p>list, <code>list(na_col = "grey")</code>; passed to
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">ComplexHeatmap::rowAnnotation()</a></code> or <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/columnAnnotation.html" class="external-link">ComplexHeatmap::columnAnnotation()</a></code></p></dd>


<dt id="arg-rowannocolmap-colmannocolmap">rowAnnoColMap, colmAnnoColMap<a class="anchor" aria-label="anchor" href="#arg-rowannocolmap-colmannocolmap"></a></dt>
<dd><p>list, <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>; the color mappings for row and column
annotations are handled automatically. Use this parameter to manually
set the color mappings, <code>names(list)</code> is the names of each annotation.
Each item of the list is a vector named by colors, similar to parameter <code>colMap</code>.</p><ul><li><p>If an annotation is numeric, the vector is numeric,
i.e. <code>c("green4"= -1, "yellow"=0, "red"=5)</code></p></li>
<li><p>If an annotation is not numeric, the vector is character,
i.e. <code>c('red'='a','pink'='b','yellow'='c')</code></p></li>
</ul></dd>


<dt id="arg-drawheatmap">drawHeatmap<a class="anchor" aria-label="anchor" href="#arg-drawheatmap"></a></dt>
<dd><p>logical, <code>TRUE</code>; it uses <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">ComplexHeatmap::draw()</a></code> to merge all
legends into one column and draw the final heatmap.</p><ul><li><p>It should be set to <code>TRUE</code> to obtain the clustering orders, i.e. by <code>column_order()</code></p></li>
<li><p>However, it should be <code>FALSE</code> if the returned
heatmap from <code>cHeatmap()</code> will be concatenated with other heatmaps.</p></li>
</ul></dd>


<dt id="arg-resetoutliers">resetOutliers<a class="anchor" aria-label="anchor" href="#arg-resetoutliers"></a></dt>
<dd><p>logical, <code>is.numeric(mat1)</code>; outliers in numeric <code>mat1</code> can
stretch the whole color scale. If <code>TRUE</code>, the bounds of the legend will
be reset to the max or min values excluding them; for example,  the legend
of <code>c(10, 0.1, 0, 0.2)</code> will be from <code>0</code> to <code>0.2</code> with the labels <code>0</code> and <code>&gt;0.2</code>.</p></dd>


<dt id="arg-clusterusingresetvalues">clusterUsingResetValues<a class="anchor" aria-label="anchor" href="#arg-clusterusingresetvalues"></a></dt>
<dd><p>logical, <code>FALSE</code>; should the clustering of
rows and columns use the reset values of outliers?</p></dd>


<dt id="arg-cellfun">cellFun<a class="anchor" aria-label="anchor" href="#arg-cellfun"></a></dt>
<dd><p><code>NULL</code>; it is used to display info for individual cells; text
info can be formatted by <code>cellFontSize</code> and <code>cellFontColor</code>. here
are different usages:</p><ul><li><p>A function to determine where and what to display at certain cells; it
takes a cell value as input and the returned value is to be displayed.
for example:</p><ul><li><p><code>cellFun = function(x){x}</code>: display the value of each cell</p></li>
<li><p><code>cellFun = function(x){if(x &gt; 10) x}</code>: display the value of cells
whose values are greater than 10</p></li>
<li><p><code>cellFun = function(x){if(x &gt; 10) '?'}</code>: display the '?' sign</p></li>
<li><p><code>cellFun = function(x){if(x &gt; 10) list('rect',col='black',lwd=2)}</code>:
color the edges black and set line width as 2. Check the parameters
of <code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">grid::gpar()</a></code> for more controls.</p></li>
</ul></li>
<li><p>A character vector or list:</p><ul><li><p><code>cellFun = 'o'</code>: display the values of all the outliers in <code>mat1</code> if any</p></li>
<li><p><code>cellFun = c('o','+')</code>: display the '+' sign instead of the value at the
outlier cells</p></li>
<li><p><code>cellFun=c('o',list('rect',col='red',lwd=2))</code>: color the outlier cells
with red edges</p></li>
</ul></li>
</ul><p>The <code>'o'</code> and <code>'rect'</code> are hard coded cases for usage convenience; for
more complicated cell drawing, use the parameter <code>cell_fun</code> of
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> directly.</p></dd>


<dt id="arg-cfmat">cfMat<a class="anchor" aria-label="anchor" href="#arg-cfmat"></a></dt>
<dd><p><code>mat1</code>; the matrix for the <em>cells</em> in <code>cellFun</code>; it should have
the same dimension as <code>mat1</code>. It gives the option of using a different
matrix for the evaluation of <code>cellFun</code> and display its results on top of
the heatmap from <code>mat1</code>.</p></dd>


<dt id="arg-cellfontsize-cellfontcolor">cellFontSize, cellFontColor<a class="anchor" aria-label="anchor" href="#arg-cellfontsize-cellfontcolor"></a></dt>
<dd><p>numeric, <code>9</code>; character, <code>"white"</code>; format
text displayed in heatmap cells.</p></dd>


<dt id="arg-rowdraw">rowDraw<a class="anchor" aria-label="anchor" href="#arg-rowdraw"></a></dt>
<dd><p>list, <code>NULL</code>; it is used to plot across rows. The list should
contain the following item:</p><ol><li><p>the function in the <code>grid</code> package to make the draw and its parameters;
for examples:</p><ul><li><p><code>list('grid.points',size = grid::unit(0.3, "char"),gp=grid::gpar(col='black'))</code>
; see <code><a href="https://rdrr.io/r/grid/grid.points.html" class="external-link">grid::grid.points()</a></code> for details. For <code>grid.point</code>, it can also
be simply coded as <code>list('grid.points',size = 0.3,pch=1,col='black')</code>;
parameter <code>col</code> and followed items are for <code>gpar()</code>.</p></li>
<li><p><code>list('grid.lines',gp=grid::gpar(col='black',lwd = 2))</code>; see
<code><a href="https://rdrr.io/r/grid/grid.lines.html" class="external-link">grid::grid.lines()</a></code> for details. For <code>grid.lines</code>, it can also be
simply coded as <code>list('grid.lines',col='black',lwd = 2)</code>
parameter <code>col</code> and followed items are for <code>gpar()</code>.</p></li>
<li><p><code>list( list('grid.points',size = 0.3,col='black'), list('grid.lines',col='black',lwd = 2) )</code> for multiple drawings</p></li>
</ul></li>
<li><p>a matrix containing the data to make the drawing, its number of columns</p></li>
<li><p>an integer vector specifying the rows to make the drawing;
if <code>NULL</code>, it means all the rows of mat1 and assumes
<code>nrow() == nrow(mat1)</code> for the supplied matrix at #2</p></li>
</ol><p>See the parameter <code>layer_fun</code> of <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> for more
complex drawing across a block of cells.</p></dd>


<dt id="arg-legendbreakdist">legendBreakDist<a class="anchor" aria-label="anchor" href="#arg-legendbreakdist"></a></dt>
<dd><p>numeric vector, NULL; set the distance portion between two breaks in
the legend and can be the following values:</p><ul><li><p><code>NULL</code>; the numeric distance among breaks</p></li>
<li><p><code>1</code>; equal distance among breaks</p></li>
<li><p>a numeric vector to represent the relative length of each section between
two breaks; its length should be <code>length(colMap) - 1</code>;
for example, <code>c(1, 1, 0.5, 3)</code> for
<code>colMap = c("green4" = -1, "white" = 0, "red" = 1, "yellow" = 3, "blue" = 18)</code></p></li>
</ul></dd>


<dt id="arg-legendheight">legendHeight<a class="anchor" aria-label="anchor" href="#arg-legendheight"></a></dt>
<dd><p>numeric, NULL; height of the vertical legend in cm.</p></dd>


<dt id="arg-legendticks">legendTicks<a class="anchor" aria-label="anchor" href="#arg-legendticks"></a></dt>
<dd><p>numeric, NULL; the legend tick; default is the <code>unname(colMap)</code></p></dd>


<dt id="arg-legendticklabels">legendTickLabels<a class="anchor" aria-label="anchor" href="#arg-legendticklabels"></a></dt>
<dd><p>character, NULL; the label of legend tick; should be the
same length as the <code>legendTicks</code>; use ” to skip a tick.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a <a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapList-class.html" class="external-link">ComplexHeatmap::HeatmapList</a> object if drawHeatmap, or
a <a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap-class.html" class="external-link">ComplexHeatmap::Heatmap</a> object otherwise.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Here are the features:</p><ol><li><p>Automatic or manual setting of the values of outliers in the input matrix so
that the color scale of the heatmap is not dominated by those outliers</p></li>
<li><p>The option to set the color-value mappings in the heatmap legend</p></li>
<li><p>Automatic coloring of the dendrogram</p></li>
<li><p>Easy highlight or display of the values of certain cells</p></li>
<li><p>Discrete color-value mapping for integer matrices containing few unique values</p></li>
<li><p>Clustering of the character matrix based on the orders of characters</p></li>
<li><p>Interface to plot across rows</p></li>
<li><p>Handling of edge cases:</p></li>
</ol><ul><li><p>Inf and -Inf values in input matrix cause errors in <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist()</a></code> for
clustering, they are reset as NA.</p></li>
<li><p>If missing values are present in the input matrix or row and column
annotations, a legend for missing value is added.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># examples at https://blueskypie.github.io/cHeatmap/articles/cHeatmap-intro.html</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jike Cui.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

